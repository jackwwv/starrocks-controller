package importCluster

import (

    "fmt"
    "time"
    "sr-controller/module"
    "sr-controller/sr-utl"
    "sr-controller/cluster/checkStatus"

)



func ImportCluster(clusterName string, topoFile string) {


    var infoMess string

    
    module.InitConf(clusterName, topoFile)
    //fmt.Println(module.GYamlConf.FeServers)
    feEntryId, err := checkStatus.GetFeEntry(-1)
    module.SetFeEntry(feEntryId)
    if err != nil {
        infoMess = fmt.Sprintf("Error in get FE Entry ID when import cluter info.")
	utl.Log("ERROR", infoMess)
    }


    module.GYamlConf.ClusterInfo.User = module.GYamlConf.Global.User
    module.GYamlConf.ClusterInfo.CreateDate = time.Unix(time.Now().Unix(), 0,).Format("2006-01-02 15:04:05")
    module.GYamlConf.ClusterInfo.MetaPath = module.GWriteBackMetaPath
    module.GYamlConf.ClusterInfo.PrivateKey = module.GSshKeyRsa


    getFeConf()
    getBeConf()
    //fmt.Println("DEBUG >>>>>>>> module.GYamlConf.ClusterInfo", module.GYamlConf.ClusterInfo)
    //fmt.Println("DEBUG >>>>>>>> module.GYamlConf.FeServers", module.GYamlConf.FeServers)
    //fmt.Println("DEBUG >>>>>>>> module.GYamlConf.BeServers", module.GYamlConf.BeServers)

    module.WriteBackMeta(module.GYamlConf, module.GYamlConf.ClusterInfo.MetaPath)

}
